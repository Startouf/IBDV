<html>
	<head>
		<meta charset="utf-8" />
     	<title>D3 stuff</title>
		<link rel="stylesheet" href="css/cyril.css" />
		<script type="text/javascript" src="js/d3.v3.js"></script>
		<script type="text/javascript">
		
		</script>
	</head>
	<body>
	<h1>SVG drawing with d3</h1>
	<h2>Doing it in html</h2>
	
	<svg width="50" height="50">
		<circle cx="25" cy="25" r="22"
		 fill="blue" stroke="gray" stroke-width="2"/>
	
	
	<circle cx="25" cy="25" r="20"
        fill="rgba(128, 0, 128, 0.75)" 
        stroke="rgba(0, 255, 0, 0.25)" stroke-width="10"/>
	</svg>
	
	<script type="text/javascript">
	d3.select("body").append("h2").text("Displaying data using basic numbers");
	
	var dataset = [ 5, 10, 15, 20, 25, 2, 3, 9, 7 ];
	var max = d3.max(dataset, function(d) { return d; });

	d3.select("body")
	.append("div")
	.attr("id", "p stuff")
	.selectAll("p")
    .data(dataset)
    .enter()
    .append("p")
	.classed("lin", true)
    .text( function(value){ return value;})
	.style("color", function(value){
		if(value > 15) {return "red"; }
		else{ return "black";}
	})
	.style("font-size", function(value) { 
		return (value/max*(24-12) +12) + "px"; });
	
	d3.select("body").append("h2").text("Now some teal bars with divs");
	
	//Draw some bars with divs
	d3.select("body")
	.append("div")
	.attr("id", "div_bars")
	.selectAll("div")
	.data(dataset)
    .enter()
    .append("div")
    .classed("bar", true)
	.style("height", function(value){ return(value*3 + "px");});
	
	d3.select("body").append("h2").text("Now good-looking bars with svg");
	
	var width = 300;
	var height = 200;
	var barPadding = 2;
	
	//Draw some bars in svg
	var svg = d3.select("body")
            .append("svg")
            .attr("width", width)   // <-- Here
            .attr("height", height); // <-- and here!
	
	svg.selectAll("rect")
		.data(dataset)
		.enter()
		.append("rect")
		.attr("x", function(value, index){
			return (index*width/dataset.length);})
		.attr("y", function(d){ return height;})
		.attr("width", width/dataset.length-barPadding)
		.attr("height", 100)
		.attr("fill", function(d) {
			return "rgb(0, 0, " + (d * 10) + ")";
		})
		.transition()
			.duration(2000)
			.attr("y", function(d){ return height-d*4;})
			.attr("fill", function(d) {
				return "rgb(0, 0, " + (d * 10) + ")";
			});
		
	
	var offsetY = -20;
	var offsetX = 3;
	
	svg.selectAll("text")
		.data(dataset)
		.enter()
		.append("text")
		.text(function(data){ return data;})
		.attr("x", function(d, i) {
			return i * (width / dataset.length) + 10;
		})
		.attr("y", function(d) {
			return height - (d * 4) - offsetY;
		})
		.attr("font-family", "sans-serif")
		.attr("font-size", "11px")
		.attr("text-anchor", "middle")
		.attr("fill", "white");
	
	d3.select("body").append("h2").text("Some Excel like (yet not) scatterplot");
	d3.select("body").append("p")
		.text("With scaling, and axis !")
		.style("font-style", "italic");
	//Scatterplot
	var dataset = [
                [5, 20], [480, 90], [250, 50.9], [100, 33], [330, 95],
                [410, 12.3], [475, 44.6], [25, 67], [85, 21], [220, 88]
              ];
	var w= 600;
	var h= 200;
	
	var svg2 = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h);
	svg2.selectAll("circle")
	   .data(dataset)
	   .enter()
	   .append("circle")
		.attr("cx", function(d) {
        return d[0];
		})
		.attr("cy", function(d) {
			return d[1];
		})
		.attr("r", function(d){
			return Math.sqrt(Math.pow(d[0],2) + Math.pow(d[1],2));
		});
	svg2.selectAll("text")
		.data(dataset)
		.enter()
		.append("text")
		.text(function(d) { return d[0] + ", " + d[1];})
		.attr("x", function(d) {
			return d[0] + 5;
		})
		.attr("y", function(d) {
			return d[1];
		})
		.attr("font-family", "sans-serif")
		.attr("font-size", "11px")
		.attr("fill", "red");
		
	//Scaling	
	var padding = 20;
	var xScale = d3.scale.linear()
		.domain([0, d3.max(dataset, function(d) { return d[0]; })])
		.range([padding, w-padding*2]);
	var yScale = d3.scale.linear()
		.domain([0, d3.max(dataset, function(d) { return d[1]; })])
		.range([h-padding, padding]);	
	var rScale = d3.scale.log()
		.domain([1, d3.max(dataset, function(d) { return d[1]; })])
		.range([1, 5]) //  /!\ Range must be >0 for log
		.nice();
	
	svg2.selectAll("circle")
		.transition()
		.duration(2000)
		.attr("cx", function(d) {
			return xScale(d[0]);
		})
		.attr("cy", function(d) {
			return yScale(d[1]);
		})
		.attr("x", function(d) {
			return xScale(d[0]);
		})
		.attr("y", function(d) {
			return yScale(d[1]);
		})
		.attr("r", function(d) {
			return rScale(Math.sqrt(Math.pow(d[0],2) + Math.pow(d[1],2)));
		})
		
	svg2.selectAll("text")
		.attr("x", function(d) {
			return xScale(d[0]) + 7;
		})
		.attr("y", function(d) {
			return yScale(d[1]);
		})
	
	//Axis
	svg2.append("g")
		.classed("axis", true)
		.attr("transform", "translate(0," + (h - padding) + ")")
		.call(d3.svg.axis()
                  .scale(xScale)
                  .orient("bottom")
				  .ticks(5)
		);
	svg2.append("g")
		.attr("class", "axis")
		.attr("transform", "translate(" + padding + ",0)")
		.call(d3.svg.axis()
                  .scale(yScale)
                  .orient("left")
				  .tickFormat(d3.format(".1"))
                  .ticks(5)
		);
	</script>
	</body>
</html>

